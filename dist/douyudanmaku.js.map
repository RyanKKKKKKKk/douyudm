{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../node_modules/fast-text-encoding/text.min.js","webpack:///../node_modules/ws/browser.js","webpack:///../src/bufferCoder.js","webpack:///../src/client.js","webpack:///../src/clientEvent.js","webpack:///../src/config.js","webpack:///../src/index.js","webpack:///../src/logger.js","webpack:///../src/messageEvent.js","webpack:///../src/stt.js","webpack:///../src/util.js","webpack:///../src/websocket.js","webpack:///./index.js","webpack:///(webpack)/buildin/global.js"],"names":["require","BufferCoder","buffer","ArrayBuffer","decoder","TextDecoder","encoder","TextEncoder","littleEndian","readLength","prototype","concat","arr","n","arguments","length","reduce","buf","message","Uint8Array","t","set","decode","callback","LE","byteLength","DataView","getUint32","slice","str","encode","of","len","r","offset","setUint32","setInt16","setInt8","blob2ab","blob","Promise","resolve","reader","FileReader","onload","e","target","result","readAsArrayBuffer","ab2blob","ab","Blob","module","exports","config","event","stt","util","bufferCoder","messageEvent","logger","Client","constructor","roomId","opts","ws","heartbeatTask","ignore","options","setOptions","clientEvent","connect","name","listener","open","disconnect","close","error","initSocket","URL","on","bind","send","serialize","login","type","roomid","joinGroup","rid","gid","heartbeat","setInterval","HEARBEAT_INTERVAL","logout","clearInterval","run","websocket","setIgnore","key","value","isObject","i","push","defOpts","debug","logfile","hasOwnProperty","isBoolean","isString","Object","assign","messageHandle","m","deserialize","dbname","isBrowser","init","echo","keys","filter","v","includes","method","clientEventName","find","toLocaleLowerCase","cb","res","messageEventName","data","MessageEvent","port","random","MSG_LIVE_ON","MSG_LIVE_OFF","MSG_ROOM_RSS","MSG_BC_BUY_DESERVE","MSG_SSD","MSG_ROOM_SPBC","danmaku","Websocket","Logger","db","inited","window","indexedDB","mozIndexedDB","webkitIndexedDB","msIndexedDB","_sql","addEventListener","createObjectStore","keyPath","autoIncrement","_fs","tx","transaction","store","objectStore","add","Date","getTime","frame","all","reject","req","getAll","count","export","text","forEach","JSON","stringify","download","clear","appendFile","err","readFile","content","split","readFileSync","loginres","chatmsg","uenter","upgrade","rss","bc_buy_deserve","ssd","spbc","dgb","onlinegift","ggbb","rankup","ranklist","mrkl","erquizisn","blab","rri","synexp","noble_num_info","gbroadcast","qausrespond","wiru","wirt","mcspeacsite","rank_change","srres","anbc","frank","STT","escape","isUndefined","toString","replace","unescape","raw","map","k","join","Array","isArray","isNumber","item","o","s","Util","p","call","min","max","Math","floor","filename","element","document","createElement","style","display","href","createObjectURL","body","appendChild","click","revokeObjectURL","removeChild","address","socket","WebSocket","code","reason","eventName","removeEventListener","douyudanmaku"],"mappings":"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","file":"douyudanmaku.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.js\");\n","(function(l){function m(){}function k(b,a){b=void 0===b?\"utf-8\":b;a=void 0===a?{fatal:!1}:a;if(-1==n.indexOf(b.toLowerCase()))throw new RangeError(\"Failed to construct 'TextDecoder': The encoding label provided ('\"+b+\"') is invalid.\");if(a.fatal)throw Error(\"Failed to construct 'TextDecoder': the 'fatal' option is unsupported.\");}if(l.TextEncoder&&l.TextDecoder)return!1;var n=[\"utf-8\",\"utf8\",\"unicode-1-1-utf-8\"];Object.defineProperty(m.prototype,\"encoding\",{value:\"utf-8\"});m.prototype.encode=function(b,\na){a=void 0===a?{stream:!1}:a;if(a.stream)throw Error(\"Failed to encode: the 'stream' option is unsupported.\");a=0;for(var g=b.length,f=0,c=Math.max(32,g+(g>>1)+7),e=new Uint8Array(c>>3<<3);a<g;){var d=b.charCodeAt(a++);if(55296<=d&&56319>=d){if(a<g){var h=b.charCodeAt(a);56320===(h&64512)&&(++a,d=((d&1023)<<10)+(h&1023)+65536)}if(55296<=d&&56319>=d)continue}f+4>e.length&&(c+=8,c*=1+a/b.length*2,c=c>>3<<3,h=new Uint8Array(c),h.set(e),e=h);if(0===(d&4294967168))e[f++]=d;else{if(0===(d&4294965248))e[f++]=\nd>>6&31|192;else if(0===(d&4294901760))e[f++]=d>>12&15|224,e[f++]=d>>6&63|128;else if(0===(d&4292870144))e[f++]=d>>18&7|240,e[f++]=d>>12&63|128,e[f++]=d>>6&63|128;else continue;e[f++]=d&63|128}}return e.slice?e.slice(0,f):e.subarray(0,f)};Object.defineProperty(k.prototype,\"encoding\",{value:\"utf-8\"});Object.defineProperty(k.prototype,\"fatal\",{value:!1});Object.defineProperty(k.prototype,\"ignoreBOM\",{value:!1});k.prototype.decode=function(b,a){a=void 0===a?{stream:!1}:a;if(a.stream)throw Error(\"Failed to decode: the 'stream' option is unsupported.\");\nb.buffer instanceof ArrayBuffer&&(b=b.buffer);b=new Uint8Array(b);a=0;for(var g=[],f=[];;){var c=a<b.length;if(!c||a&65536){f.push(String.fromCharCode.apply(null,g));if(!c)return f.join(\"\");g=[];b=b.subarray(a);a=0}c=b[a++];if(0===c)g.push(0);else if(0===(c&128))g.push(c);else if(192===(c&224)){var e=b[a++]&63;g.push((c&31)<<6|e)}else if(224===(c&240)){e=b[a++]&63;var d=b[a++]&63;g.push((c&31)<<12|e<<6|d)}else if(240===(c&248)){e=b[a++]&63;d=b[a++]&63;var h=b[a++]&63;c=(c&7)<<18|e<<12|d<<6|h;65535<\nc&&(c-=65536,g.push(c>>>10&1023|55296),c=56320|c&1023);g.push(c)}}};l.TextEncoder=m;l.TextDecoder=k})(\"undefined\"!==typeof window?window:\"undefined\"!==typeof global?global:this);\n","'use strict';\n\nmodule.exports = function() {\n  throw new Error(\n    'ws does not work in the browser. Browser clients must use the native ' +\n      'WebSocket object'\n  );\n};\n","require('fast-text-encoding')\r\n\r\nfunction BufferCoder() {\r\n    this.buffer = new ArrayBuffer(0)\r\n    this.decoder = new TextDecoder()\r\n    this.encoder = new TextEncoder()\r\n    this.littleEndian = !0\r\n    this.readLength = 0\r\n}\r\n\r\nBufferCoder.prototype.concat = function () {\r\n    const arr = []\r\n    for (let n = 0; n < arguments.length; n++) arr[n] = arguments[n]\r\n\r\n    return arr.reduce(function (arr, buf) {\r\n        const message = buf instanceof ArrayBuffer ? new Uint8Array(buf) : buf\r\n        const t = new Uint8Array(arr.length + message.length)\r\n        t.set(arr, 0)\r\n        t.set(message, arr.length)\r\n        return t\r\n    }, new Uint8Array(0))\r\n}\r\n\r\nBufferCoder.prototype.decode = function (buf, callback, LE) {\r\n    LE = LE || this.littleEndian\r\n    this.buffer = this.concat(this.buffer, buf).buffer\r\n    for (; this.buffer && this.buffer.byteLength > 0;) {\r\n        if (0 === this.readLength) {\r\n            if (this.buffer.byteLength < 4) return;\r\n\r\n            this.readLength = new DataView(this.buffer).getUint32(0, LE)\r\n            this.buffer = this.buffer.slice(4)\r\n        }\r\n\r\n        if (this.buffer.byteLength < this.readLength) return;\r\n\r\n        const str = this.decoder.decode(this.buffer.slice(8, this.readLength - 1))\r\n        this.buffer = this.buffer.slice(this.readLength)\r\n        this.readLength = 0\r\n        callback(str)\r\n    }\r\n}\r\n\r\nBufferCoder.prototype.encode = function (str, LE) {\r\n    LE = LE || this.littleEndian\r\n    let message = this.concat(this.encoder.encode(str), Uint8Array.of(0))\r\n    let len = 8 + message.length\r\n    let r = new DataView(new ArrayBuffer(len + 4))\r\n    let offset = 0\r\n\r\n    r.setUint32(offset, len, LE)\r\n    offset += 4\r\n    r.setUint32(offset, len, LE)\r\n    offset += 4\r\n    r.setInt16(offset, 689, LE)\r\n    offset += 2\r\n    r.setInt8(offset, 0)\r\n    offset += 1\r\n    r.setInt8(offset, 0)\r\n    offset += 1\r\n\r\n    return new Uint8Array(r.buffer).set(message, offset), r.buffer\r\n}\r\n\r\n/**\r\n * blob转arraybuffer\r\n * @param {Blob} blob 待转换的Blob类型参数\r\n */\r\nBufferCoder.prototype.blob2ab = function (blob) {\r\n    return new Promise((resolve, reject) => {\r\n        const reader = new FileReader()\r\n        reader.onload = function (e) {\r\n            resolve(e.target.result)\r\n        }\r\n        reader.readAsArrayBuffer(blob)\r\n    })\r\n}\r\n\r\n/**\r\n * arraybuffer转blob\r\n * @param {ArrayBuffer} ab 待转换的ArrayBuffer类型参数\r\n */\r\nBufferCoder.prototype.ab2blob = function(ab) {\r\n    return new Blob([ab])\r\n}\r\n\r\nmodule.exports = new BufferCoder()","const config = require('./config')\r\nconst event = require('./clientEvent')\r\nconst stt = require('./stt')\r\nconst util = require('./util')\r\nconst bufferCoder = require('./bufferCoder')\r\nconst messageEvent = require('./messageEvent')\r\nconst logger = require('./logger')\r\n\r\nclass Client {\r\n    constructor(roomId, opts) {\r\n        this.roomId = roomId\r\n        this.ws = null\r\n        this.heartbeatTask = null\r\n        this.messageEvent = messageEvent\r\n        this.ignore = []\r\n        this.options = this.setOptions(opts || {})\r\n        this.clientEvent = {\r\n            connect: {\r\n                name: 'open',\r\n                listener: event.open\r\n            },\r\n            disconnect: {\r\n                name: 'close',\r\n                listener: event.close\r\n            },\r\n            error: {\r\n                name: 'error',\r\n                listener: event.error\r\n            },\r\n        }\r\n    }\r\n\r\n    initSocket(ws) {\r\n        this.ws = new ws(config.URL)\r\n        this.ws.on('open', this.clientEvent.connect.listener.bind(this))\r\n        this.ws.on('error', this.clientEvent.error.listener.bind(this))\r\n        this.ws.on('close', this.clientEvent.disconnect.listener.bind(this))\r\n        this.ws.on('message', event.message.bind(this))\r\n    }\r\n\r\n    send(message) {\r\n        this.ws.send(bufferCoder.encode(stt.serialize(message)))\r\n    }\r\n\r\n    login() {\r\n        this.send({\r\n            type: 'loginreq',\r\n            roomid: this.roomId,\r\n        })\r\n    }\r\n\r\n    joinGroup() {\r\n        this.send({\r\n            type: 'joingroup',\r\n            rid: this.roomId,\r\n            gid: 0\r\n        })\r\n    }\r\n\r\n    heartbeat() {\r\n        this.heartbeatTask = setInterval(() => {\r\n            this.send({\r\n                type: 'mrkl'\r\n            })\r\n        }, config.HEARBEAT_INTERVAL * 1000)\r\n    }\r\n\r\n    logout() {\r\n        this.send({\r\n            type: 'logout',\r\n        })\r\n\r\n        clearInterval(this.heartbeatTask)\r\n        this.ws.close()\r\n    }\r\n\r\n    run(websocket) {\r\n        let ws = websocket || require('./websocket')\r\n        this.initSocket(ws)\r\n    }\r\n\r\n    setIgnore(key, value) {\r\n        if (util.isObject(key)) {\r\n            for (let i in key) {\r\n                if (key[i]) {\r\n                    this.ignore.push(i)\r\n                }\r\n            }\r\n        } else {\r\n            if (value) {\r\n                this.ignore.push(key)\r\n            }\r\n        }\r\n\r\n        return this\r\n    }\r\n\r\n    setOptions(opts) {\r\n        const defOpts = {\r\n            debug: false,\r\n            logfile: `${this.roomId}.log`,\r\n        }\r\n        const options = {}\r\n\r\n        if (!util.isObject(opts)) {\r\n            return defOpts\r\n        }\r\n\r\n        if (opts.hasOwnProperty('debug') && util.isBoolean(opts.debug)) {\r\n            options.debug = opts.debug\r\n        }\r\n\r\n        if (opts.hasOwnProperty('logfile') && util.isString(opts.logfile)) {\r\n            options.logfile = opts.logfile\r\n        }\r\n\r\n        return Object.assign(defOpts, options)\r\n    }\r\n\r\n    messageHandle(m) {\r\n        bufferCoder.decode(m, (e) => {\r\n            const r = stt.deserialize(e)\r\n\r\n            if (this.options.debug) {\r\n                const dbname = util.isBrowser() ? this.roomId : this.options.logfile\r\n                logger.init(dbname)\r\n                logger.echo(r)\r\n            }\r\n\r\n            if (Object.keys(this.messageEvent).filter(v => {\r\n                    return !this.ignore.includes(v)\r\n                }).includes(r.type)) {\r\n                this.messageEvent[r.type](r)\r\n            }\r\n        })\r\n    }\r\n\r\n    on(method, callback) {\r\n        const clientEventName = Object.keys(this.clientEvent).find(clientEvent => clientEvent === method.toLocaleLowerCase())\r\n        if (clientEventName) {\r\n            //在创建连接是触发connect事件时，发送登入，加入组，监听心跳消息\r\n            if (clientEventName === 'connect') {\r\n                let cb = callback\r\n                callback = function (res) {\r\n                    this.login()\r\n                    this.joinGroup()\r\n                    this.heartbeat()\r\n                    cb.bind(this)(res)\r\n                }\r\n            } else if (clientEventName === 'disconnect') {\r\n                let cb = callback\r\n                callback = function (res) {\r\n                    this.logout()\r\n                    cb.bind(this)(res)\r\n                }\r\n            }\r\n            this.clientEvent[method].listener = callback.bind(this)\r\n        }\r\n\r\n        const messageEventName = Object.keys(this.messageEvent).find(messageEvent => messageEvent === method.toLocaleLowerCase())\r\n        if (messageEventName) {\r\n            this.messageEvent[method] = callback.bind(this)\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = Client","function open() {\r\n    this.login() //登入\r\n    this.joinGroup() //加入组\r\n    this.heartbeat() //发送心跳，强制45秒\r\n}\r\n\r\nfunction error(err) {\r\n    console.error(err)\r\n}\r\n\r\nfunction close() {\r\n    this.logout()\r\n}\r\n\r\nfunction message(data) {\r\n    if (typeof MessageEvent !== 'undefined') {\r\n        //无MessageEvent类型判断为node环境，转换数据为arraybuffer类型\r\n        const reader = new FileReader()\r\n        reader.onload = e => this.messageHandle(e.target.result)\r\n        reader.readAsArrayBuffer(data.data)\r\n    } else {\r\n        this.messageHandle(data)\r\n    }\r\n}\r\n\r\nmodule.exports = {\r\n    open,\r\n    error,\r\n    close,\r\n    message,\r\n}","const util = require('./util')\r\n\r\n//目前已知的弹幕服务器\r\nconst port = 8500 + util.random(1, 6)\r\nconst URL = `wss://danmuproxy.douyu.com:${port}/`\r\n\r\nconst HEARBEAT_INTERVAL = 45\r\n\r\nconst MSG_LIVE_ON = '主播正在直播'\r\nconst MSG_LIVE_OFF = '主播没有直播'\r\nconst MSG_ROOM_RSS = '房间开播提醒'\r\nconst MSG_BC_BUY_DESERVE = '赠送酬勤通知'\r\nconst MSG_SSD = '超级弹幕'\r\nconst MSG_ROOM_SPBC = '房间内礼物广播'\r\n\r\nmodule.exports = {\r\n    URL,\r\n    HEARBEAT_INTERVAL,\r\n    MSG_LIVE_ON,\r\n    MSG_LIVE_OFF,\r\n    MSG_ROOM_RSS,\r\n    MSG_BC_BUY_DESERVE,\r\n    MSG_SSD,\r\n    MSG_ROOM_SPBC,\r\n}","'use strict';\r\n\r\nconst danmaku = require('./client')\r\ndanmaku.stt = require('./stt')\r\ndanmaku.util = require('./util')\r\ndanmaku.logger = require('./logger')\r\ndanmaku.Websocket = require('./websocket')\r\n\r\nmodule.exports = danmaku","const util = require('./util')\r\n\r\nconst Logger = function () {\r\n    this.dbname = 'unknown'\r\n    this.db = null\r\n    this.inited = false\r\n}\r\n\r\nLogger.prototype.init = function (dbname) {\r\n    if (!this.inited) {\r\n        this.dbname = dbname\r\n\r\n        if (util.isBrowser()) {\r\n            window.indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB\r\n            this._sql = indexedDB.open('danmaku', 1)\r\n            this._sql.addEventListener('success', e => {\r\n                console.log('连接数据库成功')\r\n                this.db = event.target.result\r\n            })\r\n\r\n            this._sql.addEventListener('upgradeneeded', e => {\r\n                this.db = event.target.result\r\n                this.db.createObjectStore(this.dbname, {\r\n                    keyPath: 'id',\r\n                    autoIncrement: true\r\n                })\r\n            })\r\n\r\n            this._sql.addEventListener('error', e => {\r\n                console.log('连接数据库出错 Error:', e)\r\n            })\r\n        } else {\r\n            this._fs = require('fs')\r\n        }\r\n        this.inited = true\r\n    }\r\n}\r\n\r\nif (!util.isBrowser()) {\r\n    Logger.prototype.echo = function (data) {\r\n        this._fs.appendFile(\r\n            this.dbname,\r\n            JSON.stringify({\r\n                t: new Date().getTime(),\r\n                frame: data\r\n            }) + '\\n',\r\n            function (err) {\r\n                if (err) {\r\n                    console.error('日志保存出错, Error:', err)\r\n                }\r\n            })\r\n    }\r\n\r\n    Logger.prototype.all = function () {\r\n        return new Promise((resolve, reject) => {\r\n            this._fs.readFile(this.dbname, 'utf8', function (err, str) {\r\n                if (err) {\r\n                    reject(err)\r\n                } else {\r\n                    resolve(str)\r\n                }\r\n            })\r\n        })\r\n    }\r\n\r\n    Logger.prototype.len = function () {\r\n        return new Promise(async (resolve, reject) => {\r\n            const content = await this.all()\r\n            resolve(content.split('\\n').filter(v => v !== '').length)\r\n        })\r\n    }\r\n\r\n    Logger.prototype.export = function () {\r\n        return this._fs.readFileSync(this.dbname, 'utf8')\r\n    }\r\n\r\n    Logger.prototype.clear = function () {\r\n\r\n    }\r\n} else {\r\n    Logger.prototype.echo = function (data) {\r\n        if (this.db !== null) {\r\n            const tx = this.db.transaction(this.dbname, 'readwrite')\r\n            const store = tx.objectStore(this.dbname)\r\n            store.add({\r\n                t: new Date().getTime(),\r\n                frame: data\r\n            })\r\n        }\r\n    }\r\n\r\n    Logger.prototype.all = function () {\r\n        if (this.db !== null) {\r\n            const tx = this.db.transaction(this.dbname, 'readonly')\r\n            const store = tx.objectStore(this.dbname)\r\n            return new Promise(function (resolve, reject) {\r\n                const req = store.getAll()\r\n                req.addEventListener('success', function (e) {\r\n                    resolve(req.result)\r\n                })\r\n                req.addEventListener('error', function (e) {\r\n                    reject(false)\r\n                })\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n    Logger.prototype.len = function () {\r\n        if (this.db !== null) {\r\n            const tx = this.db.transaction(this.dbname, 'readonly')\r\n            const store = tx.objectStore(this.dbname)\r\n            return new Promise(function (resolve, reject) {\r\n                const req = store.count()\r\n                req.addEventListener('success', function (e) {\r\n                    resolve(req.result)\r\n                })\r\n                req.addEventListener('error', function (e) {\r\n                    reject(false)\r\n                })\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n    Logger.prototype.export = async function () {\r\n        if (this.db !== null) {\r\n            const r = await this.all()\r\n            let text = ''\r\n            r.forEach((value, index) => {\r\n                text += `${JSON.stringify({\r\n                t: value.t,\r\n                frame: value.frame,\r\n            })}\\n`\r\n            })\r\n            util.download(this.dbname, text)\r\n            return text\r\n        }\r\n\r\n    }\r\n\r\n    Logger.prototype.clear = function () {\r\n        if (this.db !== null) {\r\n            const tx = this.db.transaction(this.dbname, 'readwrite')\r\n            const store = tx.objectStore(this.dbname)\r\n            store.clear()\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = new Logger()","const config = require('./config')\r\n\r\nmodule.exports = {\r\n    loginres: function (r) {\r\n        // 登录响应\r\n        // 服务端返回登录响应消息,完整的数据部分应包含的字段如下:\r\n        // 字段说明\r\n        //     type             表示为“登录”消息,固定为 loginres\r\n        //     userid           用户 ID\r\n        //     roomgroup        房间权限组\r\n        //     pg               平台权限组\r\n        //     sessionid        会话 ID\r\n        //     username         用户名\r\n        //     nickname         用户昵称\r\n        //     is_signed        是否已在房间签到\r\n        //     signed_count     日总签到次数\r\n        //     live_stat        直播状态\r\n        //     npv              是否需要手机验证\r\n        //     best_dlev        最高酬勤等级\r\n        //     cur_lev          酬勤等级\r\n    },\r\n    chatmsg: function (r) {\r\n        // 弹幕消息\r\n        // 用户在房间发送弹幕时,服务端发此消息给客户端,完整的数据部分应包含的字 段如下:\r\n        // 字段说明\r\n        //     type             表示为“弹幕”消息,固定为 chatmsg\r\n        //     gid              弹幕组 id\r\n        //     rid              房间 id\r\n        //     uid              发送者 uid\r\n        //     nn               发送者昵称\r\n        //     txt              弹幕文本内容\r\n        //     cid              弹幕唯一 ID\r\n        //     level            用户等级\r\n        //     gt               礼物头衔:默认值 0(表示没有头衔)\r\n        //     col              颜色:默认值 0(表示默认颜色弹幕)\r\n        //     ct               客户端类型:默认值 0(表示 web 用户)\r\n        //     rg               房间权限组:默认值 1(表示普通权限用户)\r\n        //     pg               平台权限组:默认值 1(表示普通权限用户)\r\n        //     dlv              酬勤等级:默认值 0(表示没有酬勤)\r\n        //     dc               酬勤数量:默认值 0(表示没有酬勤数量)\r\n        //     bdlv             最高酬勤等级:默认值 0(表示全站都没有酬勤)\r\n        console.log(\"<lv %s> [%s]  %s\", r.level + (r.level < 10 ? ' ' : ''), r.nn, r.txt)\r\n    },\r\n    uenter: function (r) {\r\n        // 进入直播间\r\n        // 具有特殊属性的用户进入直播间时,服务端发送此消息至客户端。完整的数据部 分应包含的字段如下:\r\n        // 字段说明\r\n        //     type   表示为“用户进房通知”消息,固定为 uenter\r\n        //     rid    房间 ID\r\n        //     gid    弹幕分组 ID\r\n        //     uid    用户 ID\r\n        //     nn     用户昵称\r\n        //     str    战斗力\r\n        //     level  新用户等级\r\n        //     gt     礼物头衔:默认值 0(表示没有头衔)\r\n        //     rg     房间权限组:默认值 1(表示普通权限用户)\r\n        //     pg     平台身份组:默认值 1(表示普通权限用户)\r\n        //     dlv    酬勤等级:默认值 0(表示没有酬勤)\r\n        //     dc     酬勤数量:默认值 0(表示没有酬勤数量)\r\n        //     bdlv   最高酬勤等级:默认值 0(表示全站都没有酬勤)\r\n        console.log(`欢迎<lv ${r.level}>${r.nn}进入了直播间`)\r\n    },\r\n    upgrade: function (r) {\r\n        // 用户等级提升\r\n    },\r\n    rss: function (r) {\r\n        // 房间开播提醒\r\n        // 房间开播提醒主要部分应包含的字段如下:\r\n        // 字段说明\r\n        //     type    表示为“房间开播提醒”消息,固定为 rss\r\n        //     rid     房间 id\r\n        //     gid     弹幕分组 id\r\n        //     ss      直播状态,0-没有直播,1-正在直播\r\n        //     code    类型\r\n        //     rt      开关播原因:0-主播开关播,其他值-其他原因\r\n        //     notify  通知类型\r\n        //     endtime 关播时间(仅关播时有效)\r\n        console.log(r.ss ? config.MSG_LIVE_ON : config.MSG_LIVE_OFF)\r\n    },\r\n    bc_buy_deserve: function (r) {\r\n        // 赠送酬勤通知\r\n        // 用户赠送酬勤时,服务端发送此消息至客户端。完整的数据部分应包含的字段如 下:\r\n        // 字段说明\r\n        //     type   表示为“赠送酬勤通知”消息,固定为 bc_buy_deserve\r\n        //     rid    房间 ID\r\n        //     gid    弹幕分组 ID\r\n        //     level  用户等级\r\n        //     cnt    赠送数量\r\n        //     hits   赠送连击次数\r\n        //     lev    酬勤等级\r\n        //     sui    用户信息序列化字符串,详见下文。注意,此处为嵌套序列化,需注 意符号的转义变换。(转义符号参见 2.2 序列化)\r\n    },\r\n    ssd: function (r) {\r\n        // 超级弹幕\r\n        // 超级弹幕主要部分应包含的字段如下:\r\n        // 字段说明\r\n        //     type     表示为“超级弹幕”消息,固定为 ssd\r\n        //     rid      房间 id\r\n        //     gid      弹幕分组 id\r\n        //     sdid     超级弹幕 id\r\n        //     trid     跳转房间 id\r\n        //     content  超级弹幕的内容\r\n    },\r\n    spbc: function (r) {\r\n        // 房间内礼物广播\r\n        // 房间内赠送礼物成功后效果主要部分应包含的字段如下:\r\n        //  字段说明\r\n        //     type   表示为“房间内礼物广播”,固定为 spbc\r\n        //     rid    房间 id\r\n        //     gid    弹幕分组 id\r\n        //     sn     赠送者昵称\r\n        //     dn     受赠者昵称\r\n        //     gn     礼物名称\r\n        //     gc     礼物数量\r\n        //     drid   赠送房间\r\n        //     gs     广播样式\r\n        //     gb     是否有礼包(0-无礼包,1-有礼包)\r\n        //     es     广播展现样式(1-火箭,2-飞机)\r\n        //     gfid   礼物 id\r\n        //     eid    特效 id\r\n        console.log(`------------- 感谢[${r.sn}] 赠送的 ${r.gn}x${r.gc}`)\r\n    },\r\n    dgb: function (r) {\r\n        // 赠送礼物\r\n        // 用户在房间赠送礼物时,服务端发送此消息给客户端。完整的数据部分应包含的 字段如下:\r\n        // 字段说明\r\n        //     type   表示为“赠送礼物”消息,固定为 dgb\r\n        //     rid    房间 ID\r\n        //     gid    弹幕分组 ID\r\n        //     gfid   礼物 id\r\n        //     gs     礼物显示样式\r\n        //     uid    用户 id\r\n        //     nn     用户昵称\r\n        //     str    用户战斗力\r\n        //     level  用户等级\r\n        //     dw     主播体重\r\n        //     gfcnt  礼物个数:默认值 1(表示 1 个礼物)\r\n        //     hits   礼物连击次数:默认值 1(表示 1 连击)\r\n        //     dlv    酬勤头衔:默认值 0(表示没有酬勤)\r\n        //     dc     酬勤个数:默认值 0(表示没有酬勤数量)\r\n        //     bdl    全站最高酬勤等级:默认值 0(表示全站都没有酬勤)\r\n        //     rg     房间身份组:默认值 1(表示普通权限用户)\r\n        //     pg     平台身份组:默认值 1(表示普通权限用户)\r\n        //     rpid   红包 id:默认值 0(表示没有红包)\r\n        //     slt    红包开启剩余时间:默认值 0(表示没有红包)\r\n        //     elt    红包销毁剩余时间:默认值 0(表示没有红包)\r\n    },\r\n    onlinegift: function (r) {\r\n        // 领取在线鱼丸\r\n        // 在线领取鱼丸时,若出现暴击(鱼丸数大于等于 60)服务则发送领取暴击消息 到客户端。完整的数据部分应包含的字段如下:\r\n        // 字段说明\r\n        //     type             表示为“领取在线鱼丸”消息,固定为 onlinegift\r\n        //     rid              房间 ID\r\n        //     uid              用户 ID\r\n        //     gid              弹幕分组 ID\r\n        //     sil              鱼丸数\r\n        //     if               领取鱼丸的等级\r\n        //     ct               客户端类型标识\r\n        //     nn               用户昵称\r\n        console.log(`------------- [${r.nn}] 领取鱼丸x${r.sil}`)\r\n    },\r\n    ggbb: function (r) {\r\n        // 房间用户抢红包\r\n        // 房间赠送礼物成功后效果(赠送礼物效果,连击数)主要部分应包含的字段如下:\r\n        // 字段说明\r\n        //     type  表示“房间用户抢红包”信息,固定为 ggbb\r\n        //     rid   房间 id\r\n        //     gid   弹幕分组 id\r\n        //     sl    抢到的鱼丸数量\r\n        //     sid   礼包产生者 id\r\n        //     did   抢礼包者 id\r\n        //     snk   礼包产生者昵称\r\n        //     dnk   抢礼包者昵称\r\n        //     rpt   礼包类型\r\n    },\r\n    rankup: function (r) {\r\n        // 房间内top10变化消息\r\n        // 房间内 top10 排行榜变化后,广播。主要部分应包含的字段如下:\r\n        // 字段说明\r\n        // type  表示为“房间 top10 排行榜变换”,固定为 rankup\r\n        // rid   房间 id\r\n        // gid   弹幕分组 id\r\n        // uid   用户 id\r\n        // drid  目标房间 id\r\n        // rt    房间所属栏目类型\r\n        // bt    广播类型:1-房间内广播,2-栏目广播,4-全站广播\r\n        // sz    展示区域:1-聊天区展示,2-flash 展示,3-都显示\r\n        // nk    用户昵称\r\n        // rkt   top10 榜的类型 1-周榜 2-总榜 4-日榜\r\n        // rn    上升后的排名\r\n    },\r\n    ranklist: function (r) {\r\n        // 广播排行榜消息\r\n    },\r\n    mrkl: function(r) {\r\n        // 心跳\r\n    },\r\n    erquizisn: function(r) {\r\n        // 鱼丸预言，参数未知\r\n    },\r\n    blab: function(r) {\r\n        // 粉丝等级升级\r\n        // 字段说明\r\n        // type  表示为“粉丝等级升级”,固定为 blab\r\n        // rid   房间 id\r\n        // uid   用户 id\r\n        // nn  用户昵称\r\n        // bl  升级后的等级\r\n        // bnn 升级的粉丝牌\r\n        // lbl 未知（猜测未升级前的等级）\r\n        // ba  未知\r\n    },\r\n    rri: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n    synexp: function(r) {\r\n\r\n    },\r\n    noble_num_info: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n    gbroadcast: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n    qausrespond: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n    wiru: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n    wirt: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n    mcspeacsite: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n    rank_change: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n    srres: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n    anbc: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n    frank: function(r) {\r\n        // 未知的消息事件\r\n    },\r\n}","const util = require('./util')\r\n\r\nclass STT {\r\n    escape(v) {\r\n        return util.isUndefined(v) ? '' : v.toString().replace(/\\//g, '@S').replace(/@/g, '@A')\r\n    }\r\n\r\n    unescape(v) {\r\n        return util.isUndefined(v) ? '' : v.toString().replace(/@S/g, '/').replace(/@A/g, '@')\r\n    }\r\n\r\n    serialize(raw) {\r\n        if (util.isObject(raw)) {\r\n            return Object.keys(raw).map(k => `${k}@=${this.escape(this.serialize(raw[k]))}/`).join('')\r\n        } else if (Array.isArray(raw)) {\r\n            return raw.map(v => `${this.escape(this.serialize(v))}/`).join('')\r\n        } else if (util.isString(raw) || util.isNumber(raw)) {\r\n            return raw.toString()\r\n        }\r\n    }\r\n\r\n    deserialize(raw) {\r\n        if (raw.includes('//')) {\r\n            return raw.split('//').filter(e => e !== '').map(item => this.deserialize(item))\r\n        }\r\n\r\n        if (raw.includes('@=')) {\r\n            return raw.split('/').filter(e => e !== '').reduce((o, s) => {\r\n                const [k, v] = s.split('@=')\r\n                o[k] = this.deserialize(this.unescape(v))\r\n                return o\r\n            }, {})\r\n        } else if (raw.includes('@A=')) {\r\n            return this.deserialize(this.unescape(raw))\r\n        } else {\r\n            return raw.toString()\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = new STT()","function Util() {\r\n    [\r\n        'Object',\r\n        'Array',\r\n        'String',\r\n        'Number',\r\n        'Boolean',\r\n        'Function',\r\n        'RegExp',\r\n        'Date',\r\n        'Undefined',\r\n        'Null',\r\n        'Symbol',\r\n        'Blob',\r\n        'ArrayBuffer'\r\n    ].forEach(type => {\r\n        this[`is${type}`] = (p) => Object.prototype.toString.call(p).slice(8, -1) === type\r\n    })\r\n}\r\n\r\n//判断浏览器环境\r\nUtil.prototype.isBrowser = () => (typeof window !== 'undefined') ? true : false\r\n\r\n//随机数生成\r\nUtil.prototype.random = (min, max) => Math.floor(Math.random() * (max - min + 1) + min)\r\n\r\n//web端下载文件\r\nUtil.prototype.download = function(filename, text) {\r\n    if (this.isBrowser()) {\r\n        let element = document.createElement('a');\r\n        element.style.display = 'none'\r\n        let blob = new Blob([text])\r\n        element.download = `${filename}.log`\r\n        element.href = URL.createObjectURL(blob)\r\n        document.body.appendChild(element)\r\n        element.click()\r\n        URL.revokeObjectURL(blob)\r\n        document.body.removeChild(element)\r\n    }\r\n}\r\n\r\nmodule.exports = new Util()","const util = require('./util')\r\n\r\nclass websocket {\r\n    constructor(address) {\r\n        this.listener = {}\r\n        this.socket = new WebSocket(address)\r\n    }\r\n\r\n    send(data) {\r\n        this.socket.send(data)\r\n    }\r\n\r\n    close(code, reason) {\r\n        this.socket.close(code, reason)\r\n    }\r\n\r\n    on(method, callback) {\r\n        let eventName = ['open', 'error', 'close', 'message'].find(event => event === method.toLocaleLowerCase())\r\n\r\n        if (eventName) {\r\n            if (Object.keys(this.listener).includes(eventName)) {\r\n                this.socket.removeEventListener(eventName, this.listener[eventName])\r\n            }\r\n\r\n            this.listener[eventName] = callback\r\n            this.socket.addEventListener(eventName, callback)\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = util.isBrowser() ? websocket : require('ws')","'use strict'\r\nimport douyudanmaku from '../src/index'\r\n\r\nwindow.douyudanmaku = douyudanmaku\r\nwindow.danmaku = douyudanmaku\r\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}