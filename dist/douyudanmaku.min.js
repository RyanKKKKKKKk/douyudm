!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t){function n(){["Object","Array","String","Number","Boolean","Function","RegExp","Date","Undefined","Null","Symbol","Blob","ArrayBuffer"].forEach(e=>{this["is".concat(e)]=t=>Object.prototype.toString.call(t).slice(8,-1)===e})}n.prototype.isBrowser=()=>"undefined"!=typeof window,n.prototype.random=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),n.prototype.download=function(e,t){if(this.isBrowser()){var n=document.createElement("a");n.style.display="none";var i=new Blob([t]);n.download="".concat(e,".log"),n.href=URL.createObjectURL(i),document.body.appendChild(n),n.click(),URL.revokeObjectURL(i),document.body.removeChild(n)}},e.exports=new n},function(e,t,n){"use strict";var i=n(8);i.stt=n(5),i.util=n(0),i.logger=n(4),i.Websocket=n(6),e.exports=i},function(e,t,n){var i=8500+n(0).random(1,6),r="wss://danmuproxy.douyu.com:".concat(i,"/");e.exports={URL:r,HEARBEAT_INTERVAL:45,MSG_LIVE_ON:"主播正在直播",MSG_LIVE_OFF:"主播没有直播",MSG_ROOM_RSS:"房间开播提醒",MSG_BC_BUY_DESERVE:"赠送酬勤通知",MSG_SSD:"超级弹幕",MSG_ROOM_SPBC:"房间内礼物广播"}},function(e,t,n){function i(){this.buffer=new ArrayBuffer(0),this.decoder=new TextDecoder,this.encoder=new TextEncoder,this.littleEndian=!0,this.readLength=0}n(10),i.prototype.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){var n=t instanceof ArrayBuffer?new Uint8Array(t):t,i=new Uint8Array(e.length+n.length);return i.set(e,0),i.set(n,e.length),i}),new Uint8Array(0))},i.prototype.decode=function(e,t,n){for(n=n||this.littleEndian,this.buffer=this.concat(this.buffer,e).buffer;this.buffer&&this.buffer.byteLength>0;){if(0===this.readLength){if(this.buffer.byteLength<4)return;this.readLength=new DataView(this.buffer).getUint32(0,n),this.buffer=this.buffer.slice(4)}if(this.buffer.byteLength<this.readLength)return;var i=this.decoder.decode(this.buffer.slice(8,this.readLength-1));this.buffer=this.buffer.slice(this.readLength),this.readLength=0,t(i)}},i.prototype.encode=function(e,t){t=t||this.littleEndian;var n=this.concat(this.encoder.encode(e),Uint8Array.of(0)),i=8+n.length,r=new DataView(new ArrayBuffer(i+4)),o=0;return r.setUint32(o,i,t),o+=4,r.setUint32(o,i,t),o+=4,r.setInt16(o,689,t),o+=2,r.setInt8(o,0),o+=1,r.setInt8(o,0),o+=1,new Uint8Array(r.buffer).set(n,o),r.buffer},i.prototype.blob2ab=function(e){return new Promise(t=>{var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsArrayBuffer(e)})},i.prototype.ab2blob=function(e){return new Blob([e])},e.exports=new i},function(e,t,n){function i(e,t,n,i,r,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){function s(e){i(c,r,o,s,a,"next",e)}function a(e){i(c,r,o,s,a,"throw",e)}var c=e.apply(t,n);s(void 0)}))}}var o=n(0),s=function(){this.dbname="unknown",this.db=null,this.inited=!1};s.prototype.init=function(e){this.inited||(this.dbname=e,o.isBrowser()?(window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this._sql=indexedDB.open("danmaku",1),this._sql.addEventListener("success",()=>{this.db=event.target.result}),this._sql.addEventListener("upgradeneeded",()=>{this.db=event.target.result,this.db.createObjectStore(this.dbname,{keyPath:"id",autoIncrement:!0})}),this._sql.addEventListener("error",()=>{})):this._fs=n(12),this.inited=!0)},o.isBrowser()?(s.prototype.echo=function(e){null!==this.db&&this.db.transaction(this.dbname,"readwrite").objectStore(this.dbname).add({t:(new Date).getTime(),frame:e})},s.prototype.all=function(){if(null!==this.db){var e=this.db.transaction(this.dbname,"readonly").objectStore(this.dbname);return new Promise((function(t,n){var i=e.getAll();i.addEventListener("success",(function(){t(i.result)})),i.addEventListener("error",(function(){n(!1)}))}))}},s.prototype.len=function(){if(null!==this.db){var e=this.db.transaction(this.dbname,"readonly").objectStore(this.dbname);return new Promise((function(t,n){var i=e.count();i.addEventListener("success",(function(){t(i.result)})),i.addEventListener("error",(function(){n(!1)}))}))}},s.prototype.export=r((function*(){if(null!==this.db){var e=yield this.all(),t="";return e.forEach(e=>{t+="".concat(JSON.stringify({t:e.t,frame:e.frame}),"\n")}),o.download(this.dbname,t),t}})),s.prototype.clear=function(){null!==this.db&&this.db.transaction(this.dbname,"readwrite").objectStore(this.dbname).clear()}):(s.prototype.echo=function(e){this._fs.appendFile(this.dbname,JSON.stringify({t:(new Date).getTime(),frame:e})+"\n",(function(e){}))},s.prototype.all=function(){return new Promise((e,t)=>{this._fs.readFile(this.dbname,"utf8",(function(n,i){n?t(n):e(i)}))})},s.prototype.len=function(){var e=this;return new Promise(function(){var t=r((function*(t){t((yield e.all()).split("\n").filter(e=>""!==e).length)}));return function(){return t.apply(this,arguments)}}())},s.prototype.export=function(){return this._fs.readFileSync(this.dbname,"utf8")},s.prototype.clear=function(){}),e.exports=new s},function(e,t,n){var i=n(0);function r(e){return e=(e=(e=e.toString()).replace(/@/g,"@A")).replace(/\//g,"@S")}function o(e){return e=(e=(e=e.toString()).replace(/@A/g,"@")).replace(/@S/g,"/")}e.exports={serialize:function e(t){if(i.isObject(t)){for(var n="",o=0,s=Object.entries(t);o<s.length;o++){var[a,c]=s[o];n+="".concat(r(e(a)),"@=").concat(r(e(c)),"/")}return n}return i.isArray(t)?t.map(t=>"".concat(r(e(t)),"/")).join(""):i.isString(t)||i.isNumber(t)?t.toString():""},deserialize:function e(t){var n={};if(i.isUndefined(n)||t.length<=0)return n;for(var r=t.split("/"),s=r.length-2;s>=0;s--){var a=r[s].split("@="),c=a[0],u=a[1];/^\w+@A=(.*?)@S$/.test(u)&&(u=e(o(u))),n[c]=u}return n}}},function(e,t,n){var i=n(0);e.exports=i.isBrowser()?class{constructor(e){this.listener={},this.socket=new WebSocket(e)}send(e){this.socket.send(e)}close(e,t){this.socket.close(e,t)}on(e,t){var n=["open","error","close","message"].find(t=>t===e.toLocaleLowerCase());n&&(Object.keys(this.listener).includes(n)&&this.socket.removeEventListener(n,this.listener[n]),this.listener[n]=t,this.socket.addEventListener(n,t))}}:n(14)},function(e,t,n){"use strict";n.r(t);var i=n(1),r=n.n(i);window.douyudanmaku=r.a,window.danmaku=r.a},function(e,t,n){var i=n(2),r=n(9),o=n(5),s=n(0),a=n(3),c=n(13);e.exports=class{constructor(e,t){this.roomId=e,this.ws=null,this.heartbeatTask=null,this.messageEvent=c,this.ignore=[],this.options=this.setOptions(t||{}),this.clientEvent={connect:{name:"open",listener:r.open},disconnect:{name:"close",listener:r.close},error:{name:"error",listener:r.error}}}initSocket(e){this.ws=new e(i.URL),this.ws.on("open",this.clientEvent.connect.listener.bind(this)),this.ws.on("error",this.clientEvent.error.listener.bind(this)),this.ws.on("close",this.clientEvent.disconnect.listener.bind(this)),this.ws.on("message",r.message.bind(this))}send(e){this.ws.send(a.encode(o.serialize(e)))}getMessage(e){return new Promise(t=>{a.decode(e,e=>{t(o.deserialize(e))})})}login(){this.send({type:"loginreq",roomid:this.roomId})}joinGroup(){this.send({type:"joingroup",rid:this.roomId,gid:0})}heartbeat(){this.heartbeatTask=setInterval(()=>{this.send({type:"mrkl"})},1e3*i.HEARBEAT_INTERVAL)}logout(){this.send({type:"logout"}),clearInterval(this.heartbeatTask),this.ws.close()}run(e){var t=e||n(6);this.initSocket(t)}setIgnore(e,t){if(s.isObject(e))for(var n in e)e[n]&&this.ignore.push(n);else t&&this.ignore.push(e);return this}setOptions(e){var t={debug:!1,logfile:"".concat(this.roomId,".log")},n={};return s.isObject(e)?(e.hasOwnProperty("debug")&&s.isBoolean(e.debug)&&(n.debug=e.debug),e.hasOwnProperty("logfile")&&s.isString(e.logfile)&&(n.logfile=e.logfile),Object.assign(t,n)):t}on(e,t){var n=Object.keys(this.clientEvent).find(t=>t===e.toLocaleLowerCase());if(n){if("connect"===n){var i=t;t=function(e){this.login(),this.joinGroup(),this.heartbeat(),i.bind(this)(e)}}else if("disconnect"===n){var r=t;t=function(e){this.logout(),r.bind(this)(e)}}this.clientEvent[e].listener=t.bind(this)}Object.keys(this.messageEvent).find(t=>t===e.toLocaleLowerCase())&&(this.messageEvent[e]=t.bind(this))}}},function(e,t,n){function i(e,t,n,i,r,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){function s(e){i(c,r,o,s,a,"next",e)}function a(e){i(c,r,o,s,a,"throw",e)}var c=e.apply(t,n);s(void 0)}))}}var o=n(3),s=n(0),a=n(4);function c(){return(c=r((function*(e){var t=e;"undefined"!=typeof MessageEvent&&(t=yield o.blob2ab(e.data));var n=yield this.getMessage(t);if(Object.keys(this.messageEvent).filter(e=>!this.ignore.includes(e)).includes(n.type)&&this.messageEvent[n.type](n),this.options.debug){var i=s.isBrowser()?this.roomId:this.options.logfile;a.init(i),a.echo(n)}}))).apply(this,arguments)}e.exports={open:function(){this.login(),this.joinGroup(),this.heartbeat()},error:function(){},close:function(){this.logout()},message:function(){return c.apply(this,arguments)}}},function(e,t,n){(function(e){!function(e){function t(){}function n(e,t){if(e=void 0===e?"utf-8":e,t=void 0===t?{fatal:!1}:t,-1==i.indexOf(e.toLowerCase()))throw new RangeError("Failed to construct 'TextDecoder': The encoding label provided ('"+e+"') is invalid.");if(t.fatal)throw Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}if(e.TextEncoder&&e.TextDecoder)return!1;var i=["utf-8","utf8","unicode-1-1-utf-8"];Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),t.prototype.encode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to encode: the 'stream' option is unsupported.");t=0;for(var n=e.length,i=0,r=Math.max(32,n+(n>>1)+7),o=new Uint8Array(r>>3<<3);t<n;){var s=e.charCodeAt(t++);if(55296<=s&&56319>=s){if(t<n){var a=e.charCodeAt(t);56320==(64512&a)&&(++t,s=((1023&s)<<10)+(1023&a)+65536)}if(55296<=s&&56319>=s)continue}if(i+4>o.length&&(r+=8,r=(r*=1+t/e.length*2)>>3<<3,(a=new Uint8Array(r)).set(o),o=a),0==(4294967168&s))o[i++]=s;else{if(0==(4294965248&s))o[i++]=s>>6&31|192;else if(0==(4294901760&s))o[i++]=s>>12&15|224,o[i++]=s>>6&63|128;else{if(0!=(4292870144&s))continue;o[i++]=s>>18&7|240,o[i++]=s>>12&63|128,o[i++]=s>>6&63|128}o[i++]=63&s|128}}return o.slice?o.slice(0,i):o.subarray(0,i)},Object.defineProperty(n.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(n.prototype,"fatal",{value:!1}),Object.defineProperty(n.prototype,"ignoreBOM",{value:!1}),n.prototype.decode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to decode: the 'stream' option is unsupported.");e.buffer instanceof ArrayBuffer&&(e=e.buffer),e=new Uint8Array(e),t=0;for(var n=[],i=[];;){var r=t<e.length;if(!r||65536&t){if(i.push(String.fromCharCode.apply(null,n)),!r)return i.join("");n=[],e=e.subarray(t),t=0}if(0===(r=e[t++]))n.push(0);else if(0==(128&r))n.push(r);else if(192==(224&r)){var o=63&e[t++];n.push((31&r)<<6|o)}else if(224==(240&r)){o=63&e[t++];var s=63&e[t++];n.push((31&r)<<12|o<<6|s)}else if(240==(248&r)){65535<(r=(7&r)<<18|(o=63&e[t++])<<12|(s=63&e[t++])<<6|63&e[t++])&&(r-=65536,n.push(r>>>10&1023|55296),r=56320|1023&r),n.push(r)}}},e.TextEncoder=t,e.TextDecoder=n}("undefined"!=typeof window?window:void 0!==e?e:this)}).call(this,n(11))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){},function(e,t,n){n(2);e.exports={loginres:function(){},chatmsg:function(){},uenter:function(){},upgrade:function(){},rss:function(){},bc_buy_deserve:function(){},ssd:function(){},spbc:function(){},dgb:function(){},onlinegift:function(){},ggbb:function(){},rankup:function(){},ranklist:function(){},mrkl:function(){},erquizisn:function(){},blab:function(){},rri:function(){},synexp:function(){},noble_num_info:function(){},gbroadcast:function(){},qausrespond:function(){},wiru:function(){},wirt:function(){},mcspeacsite:function(){},rank_change:function(){},srres:function(){},anbc:function(){}}},function(e,t,n){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}]);